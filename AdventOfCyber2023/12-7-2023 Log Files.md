<h3>Log Files </h3>
<b>Background:</b>
-Example
![[Pasted image 20231221132605.png]]

-Malicious activities examples
![[Pasted image 20231221132843.png]]

-Cut command
Return out certain lines by cutting into columns
```
cut -d ' ' -f1 access.log
```

-Sort and uniq
Uniq compares adjacent lines to only spit out unique lines, requires a sorted list
```
cut -d ' ' -f3 access.log | cut -d ':' -f1 | sort | uniq
```

<b>Questions:</b>
-How many unique IP addresses are connected to the proxy server? Answer: 9
	1. ```cut -d ' ' -f2 access.log | sort | uniq```

-How many unique domains were accessed by all workstations? Answer: 111
	1. ```cut -d ' ' -f3 access.log | cut -d ':' -f1 | sort | uniq | wc -l```

-What status code is generated by the HTTP requests to the least accessed domain? Answer: 503
	1. ```cut -d ' ' -f3 access.log | cut -d ':' -f1 | sort | uniq```
	2. ```grep partnerservices.getmicrosoftkey.com access.log```

-Based on the high count of connection attempts, what is the name of the suspicious domain? Answer: frostlings.bigbadstash.thm
	1. ```cut -d ' ' -f3 access.log | cut -d ':' -f1 | sort | uniq -c | sort -nr```

-What is the source IP of the workstation that accessed the malicious domain? Answer: 10.10.185.225
	1. ```grep frostlings.bigbadstash.thm access.log```

-How many requests were made on the malicious domain in total? Answer: 1581
	1.```grep frostlings.bigbadstash.thm access.log | wc -l```

-Having retrieved the exfiltrated data, what is the hidden flag? Answer: THM{a_gift_for_you_awesome_analyst!}
	1. ```grep frostlings.bigbadstash.thm access.log | cut -d ' ' -f5 | cut -d '=' -f2 | base64 -d```

